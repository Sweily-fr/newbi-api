enum PurchaseOrderStatus {
  DRAFT
  CONFIRMED
  IN_PROGRESS
  DELIVERED
  CANCELED
}

type PurchaseOrder {
  id: ID!
  prefix: String
  number: String!
  purchaseOrderNumber: String
  issueDate: String!
  validUntil: String
  deliveryDate: String
  client: EmbeddedClient!
  companyInfo: Company!
  items: [Item!]!
  status: PurchaseOrderStatus!
  headerNotes: String
  footerNotes: String
  termsAndConditions: String
  termsAndConditionsLinkTitle: String
  termsAndConditionsLink: String
  discount: Float
  discountType: DiscountType
  retenueGarantie: Float
  escompte: Float
  customFields: [CustomField!]
  totalHT: Float!
  totalTTC: Float!
  totalVAT: Float!
  finalTotalHT: Float!
  finalTotalVAT: Float
  finalTotalTTC: Float!
  discountAmount: Float
  showBankDetails: Boolean
  appearance: Appearance
  shipping: Shipping
  isReverseCharge: Boolean
  clientPositionRight: Boolean
  sourceQuote: Quote
  linkedInvoices: [Invoice]
  createdBy: User!
  createdAt: String!
  updatedAt: String!
}

type PurchaseOrderPagination {
  purchaseOrders: [PurchaseOrder!]!
  totalCount: Int!
  hasNextPage: Boolean!
}

type PurchaseOrderStats {
  totalCount: Int!
  draftCount: Int!
  confirmedCount: Int!
  inProgressCount: Int!
  deliveredCount: Int!
  canceledCount: Int!
  totalAmount: Float!
}

input CreatePurchaseOrderInput {
  prefix: String
  number: String
  purchaseOrderNumber: String
  issueDate: String!
  validUntil: String
  deliveryDate: String
  client: ClientInput!
  companyInfo: CompanyInput
  items: [ItemInput!]!
  status: PurchaseOrderStatus = DRAFT
  headerNotes: String
  footerNotes: String
  termsAndConditions: String
  termsAndConditionsLinkTitle: String
  termsAndConditionsLink: String
  discount: Float
  discountType: DiscountType
  retenueGarantie: Float
  escompte: Float
  customFields: [CustomFieldInput!]
  showBankDetails: Boolean
  appearance: AppearanceInput
  shipping: ShippingInput
  isReverseCharge: Boolean
  clientPositionRight: Boolean
  sourceQuoteId: ID
}

input UpdatePurchaseOrderInput {
  prefix: String
  number: String
  purchaseOrderNumber: String
  issueDate: String
  validUntil: String
  deliveryDate: String
  client: ClientInput
  companyInfo: CompanyInput
  items: [ItemInput!]
  status: PurchaseOrderStatus
  headerNotes: String
  footerNotes: String
  termsAndConditions: String
  termsAndConditionsLinkTitle: String
  termsAndConditionsLink: String
  discount: Float
  discountType: DiscountType
  retenueGarantie: Float
  escompte: Float
  customFields: [CustomFieldInput!]
  showBankDetails: Boolean
  appearance: AppearanceInput
  shipping: ShippingInput
  isReverseCharge: Boolean
  clientPositionRight: Boolean
}

extend type Query {
  purchaseOrder(workspaceId: ID!, id: ID!): PurchaseOrder!
  purchaseOrders(workspaceId: ID!, startDate: String, endDate: String, status: PurchaseOrderStatus, search: String, page: Int, limit: Int): PurchaseOrderPagination!
  purchaseOrderStats(workspaceId: ID!): PurchaseOrderStats!
  nextPurchaseOrderNumber(workspaceId: ID!, prefix: String): String!
}

extend type Mutation {
  createPurchaseOrder(workspaceId: ID!, input: CreatePurchaseOrderInput!): PurchaseOrder!
  updatePurchaseOrder(id: ID!, workspaceId: ID!, input: UpdatePurchaseOrderInput!): PurchaseOrder!
  deletePurchaseOrder(id: ID!, workspaceId: ID!): Boolean!
  changePurchaseOrderStatus(id: ID!, workspaceId: ID!, status: PurchaseOrderStatus!): PurchaseOrder!
  convertQuoteToPurchaseOrder(quoteId: ID!, workspaceId: ID!): PurchaseOrder!
  convertPurchaseOrderToInvoice(id: ID!, workspaceId: ID!): Invoice!
  sendPurchaseOrder(id: ID!, workspaceId: ID!, email: String!): Boolean!
}
